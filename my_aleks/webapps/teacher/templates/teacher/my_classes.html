{% extends 'teacher/teacher_base.html'%}
{% load staticfiles %}

{% block "stylesheets" %}
<style>
    *{
        margin:0;
        padding:0;

    }
    html,body{
        width:100%;
        height:100%;
    }
    label{
        display:block;
        background-color: #F5F5F5;
        height:40px;
        margin:0 auto;
        border:1px solid #dddddd;
        margin-top:10px;
        line-height: 40px;
		cursor: pointer;
    }
    .gradeText{
        margin-left: 20px;
    }
    .imgClass{
        width: 15px;
        height: 15px;
        margin-right: 5px;
    }
    .context{
        margin:0 auto;
        border:1px solid #dddddd;
		border-top:none;
        border-radius:0 2px 2 0px;
        transition:height 0.5s linear;
        -webkit-transition:height 0.5s linear;
        -moz-transition:height 0.5s linear;
        -ms-transition:height 0.5s linear;
    }
    /*input:checked + label + .context{
        visibility: visible;
       !* height:150px;*!
    }*/
    .hide {
        display: none;
    }

    @media screen and (max-width: 500px)  {
        /* .myContainer{
            width: 100%;
            margin:0 auto;
            margin-bottom: 20px;
            margin-top:30px;
            border:5px solid #1d8ce0;
            border-radius:30px;
            padding: 30px 10px;

        } */
    }



</style>

{% endblock %}



{% block "main_content" %}

          	<!-- Page Heading -->
          	<div class="app-title">
            	<h4 class="h4">我的班级</h4>
          	</div>
		  	<div class="row">
			  	<div class="col-lg-12">
				  	<div class="tile">
					  	<div class="tile-body">
							  <table class="table table-hover table-bordered" cellpadding="0" cellspacing="0">
								  <thead>
									  <th class="h6">班级</th>
									  <th class="h6">学科</th>
									  <th class="h6">人数</th>
									  <th class="h6">年级</th>
									  <th class="h6">操作</th>
								  </thead>
								  <tbody class="myContainer">
								  </tbody>
							  </table>
				  		</div>
					</div>
			  	</div>
		  	</div>

{% endblock %}

{% block "scripts" %}
    <script type="text/javascript">
        var gradeUpdate = function(grade){
            console.info("-----"+grade)
            switch (parseInt(grade)) {
                case 1 : return "小学一年级";
                case 2 : return "小学二年级";
                case 3 : return "小学三年级";
                case 4 : return "小学四年级";
                case 5 : return "小学五年级";
                case 6 : return "小学六年级";
                case 7 : return "初中一年级";
                case 8 : return "初中二年级";
                case 9 : return "初中三年级";
                case 10 : return "高中一年级";
                case 11 : return "高中二年级";
                case 12 : return "高中三年级";
            }
        };

        var gradeClick = function(grade){
            // $(".hiddenDiv").addClass("hide");
            // console.info($('div[grade_num="'+grade+'"]').hasClass("hide"))
            if($('div[grade_num="'+grade+'"]').hasClass("hide")){
                $('div[grade_num="'+grade+'"]').removeClass("hide");
                $('img[grade_num="'+grade+'"]').attr('src', "{% static "assets/img/down.png" %}");
            }else{
                $('div[grade_num="'+grade+'"]').addClass("hide");
                $('img[grade_num="'+grade+'"]').attr('src', "{% static "assets/img/add.png" %}");
            }
        };


        // //卡片点击事件
        // $(document).on("click",$(".btn .btn-link .text-success .p-0"),function () {
		// 	debugger
        //     var clsId = $(this).parent().attr("id")
        //     $(location).attr('href', '{% url "school-get-class-detail" %}?clsId=' + clsId);
        // });


        $(document).ready(function () {
            $.get("{% url 'ajax-my-classes' %}",function (data,status) {
                var dataJson = JSON.parse(data);
                var classInformation = {};
                for(var item in dataJson){
                    if(!classInformation[dataJson[item].grade]){
                        classInformation[dataJson[item].grade] = [];
                    }
                    classInformation[dataJson[item].grade].push(dataJson[item]);
                }
                var htmlString = '';
                var grade = 0;
				
					if(Object.keys(classInformation).length){
                for(var item in classInformation){
                    grade = gradeUpdate(item);
					// htmlString += '<label onclick="gradeClick('+item+')" ><span class="gradeText"><img src="{% static "assets/img/add.png" %}"  grade_num="'+item+'"  class="imgClass" >'+grade+'</span></label><div  grade_num="'+item+'"  class="context hiddenDiv hide pt-1">' ;
                    for(var value in  classInformation[item]){
                        htmlString += '<tr class="p-0 text-muted">\n' +
                            '                <td id="'+classInformation[item][value].id +'">' +classInformation[item][value].name+'</td>\n'+
							'                <td>' +classInformation[item][value].subject+'</td>\n'+
							'                <td>' +classInformation[item][value].num+'</td>\n'+
							'                <td>' +gradeUpdate(item)+'</td>\n'+
							'                <td><a class="sbtn btn-link text-succes p-0" href="{% url "school-get-class-detail" %}?clsId='+classInformation[item][value].id+'">查看详情</a></td>\n'+
							'				 </tr>'
                    }
                }
					}else{
						htmlString += '<tr class="p-0 text-muted">\n' +
						'<td colspan="5" class="text-center">暂时没有数据，快去添加吧!</td>' +
						'</tr>'
					}
                $('.myContainer').html(htmlString);
            })
        })


    </script>



{% endblock %}

